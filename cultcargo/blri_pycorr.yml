_include:
  - genesis/cult-cargo-base.yml

cabs:
  blri_pycorr:
    name: blri_pycorr
    image: 
      _use: vars.cult-cargo.images
      name: blri_pycorr

    command: blri_pycorr
    info: "Aiming to provide an optimised python library for desirable radio interferometry tasks"

    policies:
      prefix: '--'

    inputs:
      input_filepaths:
        dtype: List[str]
        info: The path to the input files be it GUPPI RAW file stem or all filepaths; Seticore Stamps filepath
        policies:
          repeat: list
          positional: true
      telescope-info-filepath:
        info: The path to telescope information (YAML/TOML or BFR5['telinfo'])
        dtype: File
        required: true
      upchannelisation-rate:
        info: The upchannelisation rate to be applied to the data
        dtype: int
        default: 1
        required: false
      integration-rate:
        info: The integration rate to be applied to the data
        dtype: int
        default: 1
        required: false
      polarisations:
        info: The polarisation characters for each polarisation, as a string (e.g. 'xy')
        dtype: str
        default: None
        required: false
      frequency-mhz-begin:
        info: The lowest frequency (MHz) of the fine-spectra to analyse (at least 1 channel will be processed)
        required: false
        dtype: float
        default: None
      frequency-mhz-end:
        info: The highest frequency (MHz) of the fine-spectra to analyse (at least 1 channel will be processed)
        dtype: float
        default: None
        required: false
      frequency-selection-percentage:
        info: A decimal percentage of the bandwidth to process [0.0, 1.0]
        dtype: float
        default: None
        required: false
      frequency-selection-center:
        info: Specifies the center of the sub-band, when processing a percentage of the bandwidth [0.0, 1.0]
        dtype: float
        default: 0.5
        required: false
      cupy:
        info: Use cupy for DSP operations
        dtype: bool
        default: false
        required: false
      dtype:
        info: The numpy.dtype to load the GUPPI RAW data as (passed as an argument to `numpy.dtype()`)
        dtype: strÂ§
        default: float32
        required: false
      unsorted-raw-filepaths:
        info: Do not sort (lexicographically) the provided GUPPI RAW filepaths
        dtype: bool
        default: false
        required: false
      invert-uvw-baselines:
        info: Instead of baseline UVWs being ant1->ant2 (`ant2 subtract ant1`), set ant2->ant1 (`ant1 subtract ant2`)
        dtype: bool
        default: false
        required: false
      invert-correlation-conjugation:
        info: Instead of conjugating ant2, conjugate ant1 for correlation (effectively conjugating conventional correlation data)
        dtype: bool
        default: false
        required: false
      stamp-index:
        info: The selective index of a stamp within a '.stamps' file. Only applicable when `input_filepaths` is a Seticore Stamps filepath
        dtype: int
        default: 0
        required: false
      stamp-timestep-increment:
        info: Set the timestep increment of the iteration through the Stamp's data. Only applicable when `input_filepaths` is a Seticore Stamps filepath
        dtype: int
        default: 0
        required: false

    outputs:
      output-filepath:
        info: The path to which the output will be written (instead of alongside the raw_filepath)
        dtype: Directory
        default: None
        required: false

